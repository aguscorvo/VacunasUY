<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xml:lang="es">


<h:head>
	<meta charset="ISO-8859-1"></meta>
	<title>VacunasUy-Administrador</title>

	<ui:include src="/WEB-INF/includes/header_lib.xhtml" />

	<style>
.selected {
	background-color: #B0BED9 !important;
}
</style>

</h:head>

<h:body>

	<header class="fixed-top header"> <ui:include
		src="/WEB-INF/includes/header_log.xhtml" /> <!-- top header -->
	<div class="navigation w-100">
		<div class="container">

			<nav class="navbar navbar-expand-lg navbar-light bg-light"> <a
				class="navbar-brand" href="/backoffice/jsf/autoridad/home.xhtml">VacunasUy</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item"><a class="nav-link"
						href="/backoffice/jsf/autoridad/enfermedades.xhtml">Enfermedades</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/backoffice/jsf/autoridad/vacunas.xhtml">Vacunas</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/backoffice/jsf/autoridad/proveedores.xhtml">Proveedores</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/backoffice/jsf/autoridad/planes.xhtml">Planes</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/backoffice/jsf/autoridad/lotes.xhtml">Lotes</a></li>

					<li class="nav-item dropdown"><a
						class="nav-link dropdown-toggle text-dark" href="#"
						id="navbarGestion" role="button" data-toggle="dropdown"
						aria-haspopup="true" aria-expanded="false"> Gesti&oacute;n </a>
						<div class="dropdown-menu" aria-labelledby="navbarGestion">
							<a class="dropdown-item"
								href="/backoffice/jsf/autoridad/enviovacunas.xhtml">Env&iacute;o
								de Vacunas</a> <a class="dropdown-item  text-dark"
								href="/backoffice/jsf/autoridad/asignacion.xhtml">Asignar
								Vacunadores</a>
						</div></li>
				</ul>
				<h:form class="form-inline">
					<p:inputText placeholder="Documento/correo" aria-label="Buscar"
						minValue="0" emptyValue="empty"
						value="#{AsignarVacunatorioBean.strbuscar}" />
					<h:commandButton class="btn btn-outline-success my-2 my-sm-0"
						action="#{AsignarVacunatorioBean.srchVacunador()}" value="Buscar" />
				</h:form>
			</div>

			</nav>
		</div>
	</div>
	</header>
	<div class="main-panel">
		<div class="container">
			<div class="col-12 d-flex flex-row">
				<div class="col-8  mb-3">
					<div class="wrapper">
						<h3>Lista de Usuarios</h3>
						<p:dataTable id="listaVacunador" var="dtVacunador"
							value="#{AsignarVacunatorioBean.usuarios}" paginator="true"
							rows="10"
							paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
							rowsPerPageTemplate="10,25,50,100">
							<p:column headerText="Nombre">
								<h:outputText
									value="#{dtVacunador.nombre + ' ' + dtVacunador.apellido}" />
							</p:column>
							<p:column headerText="Documento">
								<h:outputText value="#{dtVacunador.documento}" />
							</p:column>
							<p:column headerText="Correo">
								<h:outputText value="#{dtVacunador.correo}" />
							</p:column>
							<p:column headerText="Id" style="display: none">
								<h:outputText value="#{dtVacunador.id}" />
							</p:column>

						</p:dataTable>
					</div>
				</div>
				<div class="col-4  mb-3  border">
					<div class="wrapper">
						<h3>Asignaciones</h3>
						<div class="col-12">
							<div class="col-12  mb-3">
								<h:inputHidden value="#{AsignarVacunatorioBean.idUsuario}"
									id="addId" name="addId">

								</h:inputHidden>
								<p:outputLabel for="viewDocumento" value="Documento" />
							</div>
							<div class="col-12 d-flex flex-row">
								<h:inputText type="text" class="" id="viewDocumento"
									readonly="true" />
							</div>
						</div>
						<div id="accordion">

							<ui:repeat value="#{AsignarVacunatorioBean.atiende}" var="item">
								<div class="card">
									<div class="card-header" id="#{'heading'+ item.id}">
										<h5 class="mb-0">
											<button class="btn btn-link" data-toggle="collapse"
												data-target="#{'#collapse'+ item.id}" aria-expanded="true"
												aria-controls="#{'collapse'+ item.id}">"#{item.nombre}"</button>
										</h5>
									</div>
									<div id="collapseOne" class="collapse"
									aria-labelledby="headingOne" data-parent="#accordion">
									<div class="card-body">Anim pariatur cliche</div>
								</div>
								</div>
							</ui:repeat>

							<div class="card">
								<div class="card-header" id="headingOne">
									<h5 class="mb-0">
										<button class="btn btn-link" data-toggle="collapse"
											data-target="#collapseOne" aria-expanded="true"
											aria-controls="collapseOne">Collapsible Group Item
											#1</button>
									</h5>
								</div>

								<div id="collapseOne" class="collapse"
									aria-labelledby="headingOne" data-parent="#accordion">
									<div class="card-body">Anim pariatur cliche
										reprehenderit, enim eiusmod high life accusamus terry
										richardson ad squid. 3 wolf moon officia aute, non cupidatat
										skateboard dolor brunch. Food truck quinoa nesciunt laborum
										eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on
										it squid single-origin coffee nulla assumenda shoreditch et.
										Nihil anim keffiyeh helvetica, craft beer labore wes anderson
										cred nesciunt sapiente ea proident. Ad vegan excepteur butcher
										vice lomo. Leggings occaecat craft beer farm-to-table, raw
										denim aesthetic synth nesciunt you probably haven't heard of
										them accusamus labore sustainable VHS.</div>
								</div>
							</div>
							<div class="card">
								<div class="card-header" id="headingTwo">
									<h5 class="mb-0">
										<button class="btn btn-link collapsed" data-toggle="collapse"
											data-target="#collapseTwo" aria-expanded="false"
											aria-controls="collapseTwo">Collapsible Group Item
											#2</button>
									</h5>
								</div>
								<div id="collapseTwo" class="collapse"
									aria-labelledby="headingTwo" data-parent="#accordion">
									<div class="card-body">Anim pariatur cliche
										reprehenderit, enim eiusmod high life accusamus terry
										richardson ad squid. 3 wolf moon officia aute, non cupidatat
										skateboard dolor brunch. Food truck quinoa nesciunt laborum
										eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on
										it squid single-origin coffee nulla assumenda shoreditch et.
										Nihil anim keffiyeh helvetica, craft beer labore wes anderson
										cred nesciunt sapiente ea proident. Ad vegan excepteur butcher
										vice lomo. Leggings occaecat craft beer farm-to-table, raw
										denim aesthetic synth nesciunt you probably haven't heard of
										them accusamus labore sustainable VHS.</div>
								</div>
							</div>
							<div class="card">
								<div class="card-header" id="headingThree">
									<h5 class="mb-0">
										<button class="btn btn-link collapsed" data-toggle="collapse"
											data-target="#collapseThree" aria-expanded="false"
											aria-controls="collapseThree">Collapsible Group Item
											#3</button>
									</h5>
								</div>
								<div id="collapseThree" class="collapse"
									aria-labelledby="headingThree" data-parent="#accordion">
									<div class="card-body">Anim pariatur cliche
										reprehenderit, enim eiusmod high life accusamus terry
										richardson ad squid. 3 wolf moon officia aute, non cupidatat
										skateboard dolor brunch. Food truck quinoa nesciunt laborum
										eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on
										it squid single-origin coffee nulla assumenda shoreditch et.
										Nihil anim keffiyeh helvetica, craft beer labore wes anderson
										cred nesciunt sapiente ea proident. Ad vegan excepteur butcher
										vice lomo. Leggings occaecat craft beer farm-to-table, raw
										denim aesthetic synth nesciunt you probably haven't heard of
										them accusamus labore sustainable VHS.</div>
								</div>
							</div>
						</div>


					</div>
				</div>
			</div>
			<div class="col-12 d-flex flex-row-reverse">
				<div class="p-2">
					<div class="btn-group" data-toggle="buttons">
						<a class="btn btn-secondary" href="javascript:addAsignacion();"
							role="button" title="Agregar Asignaci&oacute;n"><i
							class="fas fa-plus"></i> </a>

					</div>
				</div>
			</div>

		</div>
	</div>


	<!-- Modal ERROR -->
	<div class="modal fade" id="error_asignacion" tabindex="-1"
		role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="errorModalLabel">Error</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true"> &times; </span>
					</button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-md-3" id="general_error_icon">
							<h1>
								<i class="fas fa-minus-circle display-3" style="color: #cc0000"></i>
							</h1>
						</div>
						<div class="col-md-9 ml-auto" id="general_error_msj">
							<!--Displays only Error Messages-->
							<h:messages globalOnly="true" styleClass="mystyle" layout="list"
								id="general_error_msj_1" infoStyle="display:none"
								warnStyle="display:none" />

						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal INFO -->
	<div class="modal fade" id="info_asignacion" tabindex="-1"
		role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="errorModalLabel">Infomraci&oacute;n</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true"> &times; </span>
					</button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-md-3" id="general_error_icon">
							<h1>
								<i class="fas fa-info-circle display-3" style="color: #F1C40F"></i>
							</h1>
						</div>
						<div class="col-md-9 ml-auto" id="general_error_msj">

							<!--Displays only Warning Messages-->
							<h:messages globalOnly="true" styleClass="messages" layout="list"
								id="general_error_msj_2" errorStyle="display:none"
								infoStyle="display:none" />

							<!--Displays only Info Messages-->
							<h:messages globalOnly="true" styleClass="messages" layout="list"
								id="general_error_msj_3" errorStyle="display:none"
								warnStyle="display:none" />
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>


	<!-- Modal ADD-->
	<div class="modal" tabindex="-1" role="dialog" id="addAsignacion">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h3 class="modal-title">Asignar Vacunador a Vacunatorio</h3>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true"> &times; </span>
					</button>
				</div>
				<div class="modal-body">
					<h:form class="addasignacion-form">
						<div class="col-12">
							<div class="col-12 d-flex flex-row">
								<h:inputHidden value="#{AsignarVacunatorioBean.idUsuario}"
									id="addId" name="addId" />
								<div class="col-6  mb-3">
									<p:outputLabel for="addIdView" value="Id" />
								</div>
								<div class="col-6  mb-3">
									<h:inputText id="addIdView" name="addIdView" readonly="true" />
								</div>
							</div>
							<div class="col-12 d-flex flex-row">
								<div class="col-3  mb-3">
									<p:outputLabel for="addDocumento" value="Documento" />
								</div>
								<div class="col-9  mb-3 mr-0 pr-0">
									<h:inputText type="text" class="form-control" id="addDocumento"
										readonly="true" />
								</div>
							</div>
							<div class="col-12 d-flex flex-row">
								<div class="col-3  mb-3">
									<p:outputLabel for="addCorreo" value="Correo" />
								</div>
								<div class="col-9  mb-3 mr-0 pr-0">
									<h:inputText type="text" class="form-control" id="addCorreo"
										readonly="true" />
								</div>
							</div>
							<div class="col-12 d-flex flex-row">
								<div class="col-3  mb-3">
									<p:outputLabel for="addName" value="Nombre" />
								</div>
								<div class="col-9  mb-3 mr-0 pr-0">
									<h:inputText type="text" class="form-control" id="addName"
										readonly="true" />
								</div>
							</div>
							<div class="col-12 d-flex flex-row">
								<div class="col-3  mb-3">
									<p:outputLabel for="addFecha" value="Fecha" />
								</div>
								<div class="col-9  mb-3 mr-0 pr-0">
									<h:inputText type="text" class="form-control"
										value="#{AsignarVacunatorioBean.fecha}" id="addFecha"
										readonly="true" />
								</div>
							</div>
							<div class="col-12 d-flex flex-row">
								<div class="col-3  mb-3">
									<p:outputLabel for="addVacunatorio" value="Vacunatorio" />
								</div>
								<div class="col-9  mb-3 mr-0 pr-0">
									<h:selectManyListbox id="addVacunatorio"
										value="#{AsignarVacunatorioBean.idVacunatorio}">
										<f:selectItems value="#{AsignarVacunatorioBean.vacunatorios}"
											var="vac" itemLabel="#{vac.id}"
											itemValue="#{vac.nombre + vac.departamento.nombre}" />
										<p:ajax update="addPuesto" />
									</h:selectManyListbox>
								</div>
							</div>
							<div class="col-12 d-flex flex-row">
								<div class="col-3  mb-3">
									<p:outputLabel for="addPuesto" value="Puesto" />
								</div>
								<div class="col-9  mb-3 mr-0 pr-0">
									<h:selectManyListbox id="addPuesto"
										value="#{AsignarVacunatorioBean.idPuesto}">
										<f:selectItems
											value="#{AsignarVacunatorioBean.selectPuestoOnVacunatorio}"
											var="puesto" itemLabel="#{puesto.id}"
											itemValue="#{puesto.numero}" />
									</h:selectManyListbox>
								</div>
							</div>
						</div>
						<div class="col-12">
							<div class="col-12 d-flex flex-row">
								<h:commandButton class="btn btn-primary"
									action="#{AsignarVacunatorioBean.addAsignacion()}"
									value="ASIGNAR" />
							</div>
						</div>
					</h:form>
				</div>
			</div>
		</div>
	</div>


	<ui:include src="/WEB-INF/includes/footer_lib.xhtml" />

	<script type="text/javascript">

	var $ds = jQuery.noConflict();

	$ds(document).ready(function() {
		var err = $ds('#general_error_msj_1 li'); 
		var info = $ds('#general_error_msj_2 li');
		var info2 = $ds('#general_error_msj_3 li'); 	

		if(err.length>0 &amp;&amp; $ds(err).css("display")!= "none"){
			$ds('#error_asignacion').modal('show');
		}

		if(info.length>0 &amp;&amp; $ds(info).css("display")!= "none"){
			$ds('#info_asignacion').modal('show');
		}	

		if(info2.length>0 &amp;&amp; $ds(info2).css("display")!= "none"){
			$ds('#info_asignacion').modal('show');
		}
	});
	
	function addAsignacion(){

		var id = $ds('#listaVacunador_data tr.selected').find("td").eq(3).html();

		if(id==undefined){
			$ds('#errorModalLabel').html('Error'),
			$ds('#general_error_icon').html('<h1 ><i class="fas fa-exclamation-triangle display-3" style="color: #cc0000" ></i></h1>');
			$ds('#general_error_msj').html('Debe Seleccionar un Usuario');
		    $ds('#error_asignacion').modal('show');
		}else{
			$ds("input[id*='addId']").val(id);
			$ds("input[id*='addIdView']").val(id);
			$ds("input[id*='addDocumento']").val($ds('#listaLote_data tr.selected').find("td").eq(1).html());
		    $ds("input[id*='addCorreo']").val($ds('#listaLote_data tr.selected').find("td").eq(2).html());
		    $ds("input[id*='addName']").val($ds('#listaLote_data tr.selected').find("td").eq(0).html());
			$ds('#addAsignacion').modal('show');
		}


	}

	
	
	$ds('#listaVacunador_data').on( 'click', 'tr', function () {
		if ( $ds(this).hasClass('selected') ) {
			$ds(this).removeClass('selected');
		}
		else {
			$ds('#listaVacunador_data tr.selected').removeClass('selected');
			$ds(this).addClass('selected');
		}
	});

</script>

</h:body>
</html>